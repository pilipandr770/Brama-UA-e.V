{% extends "base.html" %}
{% block title %}–ê–¥–º—ñ–Ω-–¥–µ—à–±–æ—Ä–¥{% endblock %}
{% block content %}
<h2>–ê–¥–º—ñ–Ω-–¥–µ—à–±–æ—Ä–¥</h2>
<hr>
<h3>–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ</h3>
<ul>
  {% for user in users %}
    <li>{{ user.email }} {% if user.is_admin %}(–∞–¥–º—ñ–Ω){% endif %} {% if user.is_blocked %}<span style="color:red;">[–∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ]</span>{% endif %}
      {% if not user.is_admin %}
        <form method="post" action="{{ url_for('admin.toggle_block_user', user_id=user.id) }}" style="display:inline;">
          <button type="submit">{% if user.is_blocked %}–†–æ–∑–±–ª–æ–∫—É–≤–∞—Ç–∏{% else %}–ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏{% endif %}</button>
        </form>
      {% endif %}
    </li>
  {% endfor %}
</ul>
<hr>
<h3>–ß–ª–µ–Ω–∏ —Ñ–µ—Ä–∞–π–Ω—É / –í–æ–ª–æ–Ω—Ç–µ—Ä–∏</h3>
<table border="1" cellpadding="6" style="border-collapse:collapse; margin-bottom:20px;">
  <tr>
    <th>–Ü–º'—è</th><th>–ü—Ä—ñ–∑–≤–∏—â–µ</th><th>–î–∞—Ç–∞ –Ω–∞—Ä.</th><th>–°–ø–µ—Ü.</th><th>–ú–µ—Ç–∞</th><th>–ú–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏</th><th>–•–æ—á–µ –∑–∞–π–º–∞—Ç–∏—Å—å</th><th>–¢–µ–ª–µ—Ñ–æ–Ω</th><th>Email</th><th>–í–Ω–µ—Å–∫–∏ (‚Ç¨)</th><th>–ó–≥–æ–¥–∞</th><th>–°—Ç–∞—Ç—É—Å</th>
  </tr>
  {% for user in users if user.is_member %}
  <tr>
    <td>{{ user.first_name }}</td>
    <td>{{ user.last_name }}</td>
    <td>{{ user.birth_date }}</td>
    <td>{{ user.specialty }}</td>
    <td>{{ user.join_goal }}</td>
    <td>{{ user.can_help }}</td>
    <td>{{ user.want_to_do }}</td>
    <td>{{ user.phone }}</td>
    <td>{{ user.email }}</td>
    <td>
      <form method="post" action="{{ url_for('admin.update_contribution', user_id=user.id) }}" style="display:inline;">
        <input type="number" step="0.01" name="contribution" value="{{ user.contributions or 0 }}" style="width:70px;">
        <button type="submit">üíæ</button>
      </form>
    </td>
    <td>{% if user.consent_given %}‚úÖ{% else %}‚ùå{% endif %}</td>
    <td>{% if user.is_blocked %}–ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ{% elif user.is_admin %}–ê–¥–º—ñ–Ω{% else %}–ê–∫—Ç–∏–≤–Ω–∏–π{% endif %}</td>
  </tr>
  {% endfor %}
</table>
<hr>
<h3>–ë–ª–æ–∫–∏ –Ω–∞ –≥–æ–ª–æ–≤–Ω—ñ–π</h3>
<a href="{{ url_for('admin.create_block') }}">+ –î–æ–¥–∞—Ç–∏ –±–ª–æ–∫</a>
<ul>
  {% for block in blocks %}
    <li>{{ block.title }} ({{ block.type }})
      <a href="{{ url_for('admin.edit_block', block_id=block.id) }}">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
      <form method="post" action="{{ url_for('admin.delete_block', block_id=block.id) }}" style="display:inline;">
        <button type="submit" onclick="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –±–ª–æ–∫?');">–í–∏–¥–∞–ª–∏—Ç–∏</button>
      </form>
    </li>
  {% endfor %}
</ul>
<hr>
<h3>–ì–∞–ª–µ—Ä–µ—è</h3>
<a href="{{ url_for('admin.add_gallery_image') }}">+ –î–æ–¥–∞—Ç–∏ —Ñ–æ—Ç–æ</a>
<ul>
  {% for img in gallery %}
    <li><img src="{{ img.image_url }}" alt="" width="80"> {{ img.description }}
      <form method="post" action="{{ url_for('admin.delete_gallery_image', image_id=img.id) }}" style="display:inline;">
        <button type="submit" onclick="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ñ–æ—Ç–æ?');">–í–∏–¥–∞–ª–∏—Ç–∏</button>
      </form>
    </li>
  {% endfor %}
</ul>
<hr>
<h3>–ü—Ä–æ–µ–∫—Ç–∏</h3>
<ul>
  {% for project in projects %}
    <li style="margin-bottom: 18px;">
      <strong>{{ project.title }}</strong> ({{ project.status }})
      {% if project.image_data or project.image_url %}
        <br>
        <img src="{{ url_for('main.project_image_file', project_id=project.id) }}" alt="—Ñ–æ—Ç–æ –ø—Ä–æ—î–∫—Ç—É" style="max-width:120px; max-height:80px; border-radius:8px;">
      {% endif %}
      <br>
      {% if project.status == 'pending' %}
        <form method="post" action="{{ url_for('admin.approve_project', project_id=project.id) }}" style="display:inline;">
          <button type="submit" style="color:green;">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
        </form>
        <form method="post" action="{{ url_for('admin.reject_project', project_id=project.id) }}" style="display:inline;">
          <button type="submit" style="color:red;">–í—ñ–¥—Ö–∏–ª–∏—Ç–∏</button>
        </form>
      {% endif %}
    </li>
  {% endfor %}
</ul>
<hr>
<h3>–°–æ—Ü–º–µ—Ä–µ–∂—ñ</h3>
<p>Facebook: {{ settings.facebook if settings else '' }}<br>Instagram: {{ settings.instagram if settings else '' }}<br>Telegram: {{ settings.telegram if settings else '' }}<br>Email: {{ settings.email if settings else '' }}</p>
<hr>
<a href="{{ url_for('admin.edit_social_settings') }}" style="font-weight:bold; font-size:1.1em; color:#007bb8;">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–æ—Ü–º–µ—Ä–µ–∂—ñ</a>
<hr>
<h3>–ó–≤—ñ—Ç–∏</h3>
<ul>
  {% for report in reports %}
    <li>{{ report.title }} ({{ report.created_at.strftime('%Y-%m-%d') }})</li>
  {% endfor %}
</ul>
{% endblock %} 